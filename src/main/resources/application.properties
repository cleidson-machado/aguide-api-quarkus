# ========== DATABASE ==========
quarkus.datasource.db-kind=postgresql
quarkus.datasource.jdbc.url=${QUARKUS_DATASOURCE_JDBC_URL:jdbc:postgresql://localhost:5432/quarkus_db}
quarkus.datasource.username=${QUARKUS_DATASOURCE_USERNAME:quarkus}
quarkus.datasource.password=${QUARKUS_DATASOURCE_PASSWORD:quarkus123}

# ========== HIBERNATE ORM ==========
# ?? MUDANÇA CRÍTICA: Agora o Flyway controla o schema, não o Hibernate!
quarkus.hibernate-orm.database.generation=none
quarkus.hibernate-orm.log.sql=true

# ?? REMOVIDO: quarkus.hibernate-orm.sql-load-script (Flyway vai gerenciar)
# ?? REMOVIDO: quarkus.hibernate-orm.sql-load-script-phase (não precisa mais)

# ========== FLYWAY ==========
# Executa migrações automaticamente na inicialização
quarkus.flyway.migrate-at-start=true

# Cria a tabela flyway_schema_history se não existir
quarkus.flyway.baseline-on-migrate=true

# Versão inicial (útil se você já tem um banco com dados)
quarkus.flyway.baseline-version=0

# Localização dos scripts de migração
quarkus.flyway.locations=db/migration

# ========== CONSOLE & LOGGING (DEV MODE) ==========
# Correção DEFINITIVA para NullPointerException no StartupLogCompressor
# DESABILITA o console interativo que causa o problema
quarkus.console.enabled=false

# Desabilita o console colorido/fancy que está causando problemas
quarkus.log.console.color=false

# Formato simples de log (sem status line interativo)
quarkus.log.console.format=%d{HH:mm:ss} %-5p [%c{2.}] (%t) %s%e%n

# Aumenta o nível de log das categorias problemáticas para WARN (mais restritivo)
quarkus.log.category."io.quarkus.deployment.console".level=WARN
quarkus.log.category."io.quarkus.dev.console".level=WARN
quarkus.log.category."io.quarkus.bootstrap.classloading".level=WARN
quarkus.log.category."org.aesh".level=WARN

# Reduz o nível de log do Netty para evitar poluição
quarkus.log.category."io.netty".level=INFO

# ========== CORS ==========
quarkus.http.cors=true
quarkus.http.cors.origins=*
quarkus.http.cors.methods=GET,PUT,POST,DELETE,PATCH,OPTIONS
quarkus.http.cors.headers=accept,authorization,content-type,x-requested-with

# ========== JWT SECURITY ==========
# Chaves RSA para assinatura e validação de tokens JWT
# SOLUÇÃO: Usar chave inline em vez de arquivo (evita problemas de parsing)
# A chave privada está em formato PEM completo (BEGIN/END tags incluídos)
mp.jwt.verify.publickey.location=security/jwt-public.pem
mp.jwt.sign.key-content=-----BEGIN PRIVATE KEY-----\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDTNDr6TzWRIVkH\nL7u//q1rEJC+Xc2Rhh/t4UoRntbS+LytLupLkuXO1+U5Ztc51iCyImQP4bYC/YSo\nTlOgMZJYzysjrVOANtdGkLdvc54icGTmPAelMUXoZFCn0zazRBKSCGjnyOE5nqb+\nrs24E71enJyF/yFJB/JGsSWijjrKySJj9ZtKJp3Q1Jlj8i7UfS4kpMFzsnp7zI99\nVNzcNjzVBZZM698Htyy3oyjf9J2kkNGeWjPPrv+A3dLrOOVmwqB2r8Wda/dDtFVR\nJEBxoRoPaaVVQ7mp3Mj+TFmEgpoge1XY750bmxGt0hJCvoVCCXS27djFs5LihQyD\nXrLVtYSbAgMBAAECggEAHwpuIJvDo7DjBMtfLLihhDrLCy9+JwUvbCbQXAacTCWC\nlXFvveu5Gs1gQy96MmXmKEglrK/fsFDSTmo0oDao66SHEpdGznFA8n4Sd67mbulV\n6wCnnv++5ojX0dKZF3/JuuzBfk9nyrAmmwfV9FfyXRVna8ozeihQ01L11Q5SVbs1\njm8dgxfa6rLa1gyjeMJSBaA6CcJ1AQWHkCJAKxYK7Rjw7NsaWOwmsTBKCnCZhSIc\nkR/ULH0qbgGBlaD/Nd4icwCN0wWgs8vlkDaoI/ypguhQ3RdkiH30MTWmCIB+Fm00\npt2FIYJhfPYmjodKUNSTGmtlNah/PMkpcVy3EpehAQKBgQDw0IeLEE+SLXLPfrqY\nF7zLG47gWmnst93IeQIZXA998Zbmq5KvIfGI2OSjNEFCWK984t9LNh4JwqKNrm/3\n3eojqkGyO/520t6Of8ndw+8weTT0xnMl4kyzc3OKTsaYARuZoqid8vSJbKzvPAhy\nVHIE2rjcZeSI97qopKwKSTJT/QKBgQDghbKi4NH+0Bel8BMwiLeYZ9s0LqOXB0Rz\nF5+5ymemI/erOUSVbNQb3G6zvNpf0mACksCCNnKVVwEFr4iWLQ/5XckOm5haV9Xz\n/2FkhZgJ6sgmoigiqpRsvZ2B3RvwgOGRJ1X8ohJ3QxF7WorjgnVP/kRN/nzV5Xbg\nMC6bYnKCdwKBgH1ID2wSlUL4MAWw6YRcvRRxhthDUV4cnd5Azg3BbjHYcOgalJpW\nL2FBbVlWwyiwGMQBB6gKRIBRaN4KxSePpNLfLYR7X7wTokNCShP8bkCqnhlF8Pvh\nioPFaXOn3fuQf/pivBRIJF4mUqW3drF8K0FJROksfUOgldRMr1A+mldFAoGBAJsv\njgNKhZssVcwaHglj1hJ/ZmGxAt125nbukzYlknKhVaSBlsf5SrpfKB0PoZitnjLp\nICpgW96hHlHBvBSg3POtQTTZkvqOz5EwqS6DsEzafLFHT5p2cNSgUufZ3l/jlQVx\nPNu7YiwQrVqngGw0VcWOp8OI7NwjGIFojC5WY3ONAoGAd0vRsNx+CGrVnXvBRdca\n8o4jQv2pRNiGUSt/noEV4jc7UoQiNB37DpybPX6rR92BtLeva5g3kbmuJsxy/FgR\nWAAsNcC5PTMgQTJMPlOEhtKB3X12Arz+kzYIAfYStMqUHbBGGJXF5HiR5iJge2G/\n8tHsAM14myW5Ft0N2KGHlUQ=\n-----END PRIVATE KEY-----

# Issuer do token (identificador único da API)
mp.jwt.verify.issuer=https://aguide.com.br
smallrye.jwt.sign.issuer=https://aguide.com.br

# Tempo de expiração do token (em segundos)
# 3600 = 1 hora | 7200 = 2 horas | 86400 = 24 horas
jwt.expiration.time=${JWT_EXPIRATION_TIME:3600}

# Desabilita autenticação HTTP Basic (usaremos JWT Bearer)
quarkus.http.auth.basic=false

# Path do security realm (opcional, mas recomendado)
quarkus.http.auth.permission.public.paths=/api/v1/auth/login,/api/v1/auth/register,/api/v1/auth/health,/q/*
quarkus.http.auth.permission.public.policy=permit

# Todos os outros endpoints requerem autenticação JWT
quarkus.http.auth.permission.authenticated.paths=/*
quarkus.http.auth.permission.authenticated.policy=authenticated

# ========== CONFIGURAÇÕES ESPECÍFICAS DE AMBIENTE ==========
# As configurações de HTTP, SSL e Flyway agora estão em:
#   - application-dev.properties  (desenvolvimento)
#   - application-prod.properties (produção)
#
# Para alternar entre ambientes, configure a variável:
#   QUARKUS_PROFILE=dev   ou   QUARKUS_PROFILE=prod
